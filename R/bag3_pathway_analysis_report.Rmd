---
title:               "BAG3 Pathway Analysis"
author:
  - name:            "Emir Turkes"
  - name:            "Columbia University"
date:                '`r strftime(Sys.time(), format = "%B %d, %Y")`'
bibliography:        "../bag3-pathway-analysis.bib"
biblio-style:        apalike
link-citations:      true
output:
  html_document:
    number_sections: true
    theme:           lumen
    toc:             true
    toc_depth:       2
    toc_float:
      collapsed:     false
      smooth_scroll: false
knit:
  (function(inputFile, encoding) {
    rmarkdown::render(
      inputFile, encoding = encoding, output_file = "../results/bag3-pathway-analysis-report.html")})
---

```{r, include = FALSE}
# Copyright 2019 Emir Turkes
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

knitr::opts_chunk$set(echo = TRUE, fig.width = 8.5)
```

<style type="text/css">
body {font-size: 16px;}
h1.title {font-size: 35px;}
h1 {font-size: 24px;}
h2 {font-size: 22px;}
h3 {font-size: 20px;}
.toc-content {padding-left: 0px; padding-right: 0px;}
div.tocify {width: 100%;}
.tocify-subheader .tocify-item {font-size: 0.95em; padding-left: 25px; text-indent: 0;}
div.main-container {max-width: none; width: 100%;}
</style>

*This is an in-depth analysis based on one or more initial broad analyses.*

The goal of this analysis is to explore the functional role of [BAG3 (BCL2 Associated Athanogene 3)](https://www.genecards.org/cgi-bin/carddisp.pl?gene=BAG3).

Datasets used in this analysis include:

- [github.com/eturkes/bag3-co-ip](https://github.com/eturkes/bag3-co-ip): Co-IP MS (co-immunoprecipitation mass spectrometry) data using BAG3 as bait.

This analysis was performed in R except where noted.
The source code and instructions for rerunning the analysis can be found at [github.com/eturkes/bag3-pathway-analysis](https://github.com/eturkes/bag3-pathway-analysis).

# Final Results

**Read just this section for the final results of the analysis and a brief summary of the methods.**

# ~~~~ Breakdown of Methods ~~~~ {-}

The following top-level sections breakdown the methods used to perform the analysis.
We start by loading in any required packages for our analysis and setting some global variables.

```{r}
library(conflicted)
library(devtools)
library(DT)
```

```{r}
assets_dir <- file.path(getwd(), "..", "assets")
results_dir <- file.path(getwd(), "..", "results")
```

# Original Data

The following subsection(s) provide a brief overview of the datasets used in this analysis.

## BAG3 Co-IP MS {.tabset}

Source: [github.com/eturkes/bag3-co-ip](https://github.com/eturkes/bag3-co-ip)

The final Co-IP MS dataset after cleaning as described in the reportâ€™s method section.
Briefly, the original dataset was subject to missing value imputation via a custom method, renormalized, and changes between scr and shBAG3 conditions were hypothesis tested using the beta-binomial method.
Additional validation was performed using Watson for Drug Discovery.
Two sort schemes are presented, one to show specificity with BAG3 and another to show the most abundant Co-IP proteins.
Ideally, the two schemes would be combined to show which proteins interacted most highly with BAG3, but this is nontrivial to do accurately considering experimental limitations.

```{r}
co_ip_genes <- readRDS(file.path(assets_dir, "bag3-co-ip", "co_ip_genes.rds"))
cols <- c("Gene", "BAG3 Specificity", "Abundance Ratio",
          "Watson Confidence", "scrRNA Abundance", "shBAG3 Abundance")
```

### Specificity with BAG3

```{r}
co_ip_genes_spec <- co_ip_genes[order(-co_ip_genes[[cols[2]]], co_ip_genes[[cols[6]]]), ]
rownames(co_ip_genes_spec) <- NULL # Reset row numbers.
eturkesRutils::datatable(co_ip_genes_spec) %>% # From my own package, provides custom formatting.
  formatRound(c(2, 3, 4)) %>% formatStyle(cols[1], `text-align` = "center")
```

### Abundance of Protein

```{r}
co_ip_genes_abun <- co_ip_genes[order(-co_ip_genes[[cols[5]]], -co_ip_genes[[cols[6]]]), ]
rownames(co_ip_genes_abun) <- NULL # Reset row numbers.
eturkesRutils::datatable(co_ip_genes_abun) %>% # From my own package, provides custom formatting.
  formatRound(c(2, 3, 4)) %>% formatStyle(cols[1], `text-align` = "center")
```

# g:Profiler

We start by taking our gene lists and inputing them into [g:Profiler](https://biit.cs.ut.ee/gprofiler/gost), a web service for functional enrichment analysis [@raudvere_g:profiler:_2019].
g:Profiler is the first step in a 2019 Nature Protocols paper on pathway analysis [@reimand_pathway_2019] that we will generally be following for this analysis.
While an official R client was trialed for this section, it was found to have various deficiencies, so we opt to use the web GUI.
Fortunately, reproducibility is granted through an auto-query feature, where a web URL is generated that leads to the original request.
These URLs are included here and are also useful for interactive exploration.

Two figures are provided in each subsection:

- A Manhattan plot which shows the relative enrichment of various data source terms.
By visiting the web app, one can click the circles and generate a table comparing the terms between the two gene lists.
- A table breaking data source terms, their p-values, and genes determined to be associated with each term.

## BAG3 Co-IP MS {.tabset}

Since we have two gene lists from this set that are nontrivial to combine, we shall continue analyzing them in parallel.
Below are the parameters used for each list, documentation for which can be found [here](https://biit.cs.ut.ee/gprofiler/page/docs).
An important caveat to consider is `no iea`, which when true, includes electronic GO annotations generated in-silico that are considered of lower confidence than manually curated.
To present the results as clearly as possible, we opt to include these electronic annotations in the Manhattan plot but not the tables nor later analyses in this report.

```
version = e95_eg42_p13_f6e58b9
organism = rnorvegicus
all results = false
ordered = true
no iea = true # false in Manhattan plot.
sources = GO:MF, GO:CC, GO:BP, KEGG, REAC
combined = false # true in Manhattan plot.
numeric ns = ENTREZGENE_ACC
domain scope = annotated
measure underrepresentation = false
significance threshold method = g_SCS
user threshold = 0.05
no evidences = false
```

It should also be noted that the following queries contain genes that are considered ambiguous by g:Profiler and must be manually resolved and has been done for the following figures.
These resolutions are not recorded with the auto-query feature, so must be done again when visiting the interactive link.

The following resolutions were performed:

```
BAG5 -> ENSRNOG00000011527
HIST1H4B -> ENSRNOG00000032224
MYH9 -> ENSRNOG00000004860
RPL12 -> ENSRNOG00000028993
RPS27A -> ENSRNOG00000004426
```

And the following were excluded due to the lack of resolution suggestions from g:Profiler:

```
LRRC16B
```

### Manhattan Plot

***[Link to Interactive Version](https://biit.cs.ut.ee/gplink/l/rwPdvoegQS)***

![](../assets/gprofiler/bag3-co-ip/manhattan.png)

### Specificity with BAG3 Table

***[Link to Interactive Version](https://biit.cs.ut.ee/gplink/l/O4Zn-_pwR9)***

![](../assets/gprofiler/bag3-co-ip/spec-table.png)

### Abundance of Protein Table

***[Link to Interactive Version](https://biit.cs.ut.ee/gplink/l/4uaf8DTIT3)***

![](../assets/gprofiler/bag3-co-ip/abun-table.png)

# GSEA

GSEA (gene set enrichment analysis) [@subramanian_gene_2005], is a common pathway analysis method when dealing with a ranked gene list.
However, this method is only suitable when near-genomewide expression profiles are available, which means certain datasets, like that from the BAG3 Co-IP MS analysis, cannot be used.

# Watson for Drug Discovery

IBM's [Watson for Drug Discovery](https://www.ibm.com/products/watson-drug-discovery) (WDD) is a text-mining platform that has built a massive corpus of scientific insights drawn from publications and other data forms.
Various insights based on co-occurance in literature can be obtained with and without input lists of data, which can take the form of various entities (genes, drugs, diseases, etc).
It should be noted that WDD does not take into account list order, so sort schemes will not matter.
WDD also lacks an API, so this section was done manually rather than programmatically.

WDD has several distinct tools, which are summarized here:

- Explore a Network: A visualization of entities that co-occur with the input entities.

## BAG3 Overview

First, we use WDD's tools to get an overview of BAG3 without the addition of any datasets.

### Explore a Network {.tabset}

Each tab describes the co-occurance of the named entity with BAG3.

#### Genes

Parameters:

```
Minimum Confidence = 1
Minimum Documents = 1
```

![](../assets/watson/network/overview-genes.png)

#### Mutant Genes

Parameters:

```
Minimum Confidence = 1
Minimum Documents = 1
```

![](../assets/watson/network/overview-mutant.png)

#### Conditions

Parameters:

```
Minimum Confidence = 7 # No entities below this value.
Minimum Documents = 1
```

![](../assets/watson/network/overview-conditions.png)

#### Adverse Events

Parameters:

```
Minimum Confidence = 2 # No entities below this value.
Minimum Documents = 1
```

![](../assets/watson/network/overview-adverse.png)

#### Drugs

Parameters:

```
Minimum Confidence = 63 # No entities below this value.
Minimum Documents = 1
```

![](../assets/watson/network/overview-drugs.png)

#### Chemicals

Parameters:

```
Minimum Confidence = 16 # No entities below this value.
Minimum Documents = 1
```

![](../assets/watson/network/overview-chemicals.png)

# Visualization

Cytoscape [@shannon_cytoscape:_2003] is an open-source platform for visualization of networks with an extensive collection of third-party apps.
Together with the apps Enrichment Map [@merico_enrichment_2010] and AutoAnnotate [@kucera_autoannotate:_2016], results from g:Profiler, GSEA, and more can be visualized in an intuitive way.
Although APIs exist to carry out this process programmatically, it is unwieldy considering that networks must be manually adjusted in almost all cases, so at least for the time being we opt to use the Cytoscape GUI.
Links to figures in [CyNetShare](https://idekerlab.github.io/cy-net-share/) are also provided, which allow for interactive exploration of data with the caveat that there are slight alterations in the layout of nodes and the large clusters from AutoAnnotate cannot be displayed.

## BAG3 Co-IP MS {.tabset}

Starting with this set, we again separate the analysis by the gene list we use.
The following parameters were used for the following set of tabs.

```
Data source = g:Profiler
P-value = 1.0
FDR Q-value = 0.1
Test used = Jaccard Overlap Combined Index (k constant = 0.5)
Jaccard Overlap Combined = 0.375
```

### Specificity vs. Abundance

The following figure shows the difference in enriched pathways when assessing enrichment with both gene lists present.
Based on the number of two-color nodes, we see that while most pathways overlap, some are enriched more highly in one set over the other.

***[Link to Interactive Version](http://cynetshare.ucsd.edu/#/https%253A%252F%252Fgist.githubusercontent.com%252Feturkes%252F7360dbccb8db210fef7ef8385eded0e5%252Fraw%252F0b08653728057fbec9618ce6106810ca0aeafd9c%252Fspec%252Babun.cyjs?stylefile=https%3A%2F%2Fgist.githubusercontent.com%2Feturkes%2F81a5654d3b9e81945d7a65e174b0b1e1%2Fraw%2Fd9904faf86da0e74fb1554dacc6a9a5e8c26a025%2Fspec%2Babun.json&selectedstyle=EM1_Visual_Style&x=1230.4311528126464&y=-154.51040425965567&zoom=0.9781743467916821&bgcolor=%23FAFAFA)***

![](../assets/cytoscape/bag3-co-ip/spec+abun.svg)

### Specificity with BAG3

***[Link to Interactive Version](http://cynetshare.ucsd.edu/#/https%253A%252F%252Fgist.githubusercontent.com%252Feturkes%252F71aac16c39bdaf4104b53b905fa59515%252Fraw%252F377ecda8b5ce83ad7aa6844de62c5b234f3efd5f%252Fspec.cyjs?stylefile=https%3A%2F%2Fgist.githubusercontent.com%2Feturkes%2F58ee5a6197403c08acf0ca925aec8a60%2Fraw%2Ff849ef446d656f16e1919f5897668a9bb12e27f7%2Fspec.json&selectedstyle=EM1_Visual_Style&x=320.04823758826353&y=277.3714084746141&zoom=1.1210240975899868&bgcolor=%23FAFAFA)***

![](../assets/cytoscape/bag3-co-ip/spec.svg)

### Abundance of Protein

***[Link to Interactive Version](http://cynetshare.ucsd.edu/#/https%253A%252F%252Fgist.githubusercontent.com%252Feturkes%252F4fecb1bbf3285a2fe2e043f052092cb5%252Fraw%252F62686a1869490eee957cb8c3aa998b13cf4fc729%252Fabun.cyjs?stylefile=https%3A%2F%2Fgist.githubusercontent.com%2Feturkes%2F756cc7fd5c35b2cf21eb2fab0ee05b83%2Fraw%2F8a536478b9cb5200a102f795dad12b9fbdfc3cca%2Fabun.json&selectedstyle=EM1_Visual_Style&x=1117.1577411836033&y=557.2973269612608&zoom=1.0987881493574445&bgcolor=%23FAFAFA)***

![](../assets/cytoscape/bag3-co-ip/abun.svg)

# References

This is the concluding section of the document.
Here we write our data to disk for exploration in `Final Results` at the top of this report, output the `session_info`, and create a bibliography for works cited.

```{r}
session_info()
```
